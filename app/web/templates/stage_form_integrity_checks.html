{% extends "layout.html" %}

{% block title %}{{ 'Edit' if edit else 'Create' }} Integrity Stage{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='tomselect/tom-select.bootstrap5.min.css') }}">
<script src="{{ url_for('static', filename='tomselect/tom-select.complete.js') }}"></script>
{% include "partials/tom_select_deg.html" %}
{% endblock %}

{% block content %}
{% include "partials/_flashes.html" %}
<h1>{{ 'Edit' if edit else 'Create' }} Integrity Stage</h1>

<form method="post">
    <div class="mb-3">
        <label class="form-label" for="stage_name">Stage Name</label>
        <input class="form-control" id="stage_name" name="stage_name" value="{{ stage.name or '' }}" required>
    </div>

    <div class="mb-3">
        <label class="form-label" for="orgunit_level">Org Unit Level</label>
        <input class="form-control" id="orgunit_level" name="orgunit_level" type="number" value="{{ stage.level or 1 }}"
               required>
    </div>

    <div class="mb-3">
        <label class="form-label" for="duration">Duration (e.g. 12 months)</label>
        <input class="form-control" id="duration" name="duration" value="{{ stage.duration or '12 months' }}" required>
    </div>

    <div class="mb-3">
        <label class="form-label" for="monitoring_group">Monitoring data element group</label>
        <select id="monitoring_group" name="monitoring_group" placeholder="Search..." class="form-select">
            {% if stage.params.monitoring_group %}
            <option value="{{ stage.params.monitoring_group }}" selected>
                {{ deg_name or stage.params.monitoring_group }}
            </option>
            {% endif %}
        </select>

    </div>
    <div class="mb-3">
        <label class="form-label" for="period_type">Period Type</label>
        <select id="period_type" name="period_type" class="form-select" required>
            {% set selected = stage.params.period_type %}
            {% for pt in ['Daily', 'Weekly', 'Monthly', 'Quarterly', 'Yearly'] %}
            <option value="{{ pt }}" {% if pt== selected %}selected{% endif %}>{{ pt }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="mb-3">
        <input class="form-check-input" type="checkbox" id="active" name="active" {% if stage.active %}checked{% endif
               %}>
        <label class="form-check-label" for="active">Active</label>
    </div>

    <button class="btn btn-primary" type="submit">{{ 'Update' if edit else 'Create' }} Stage</button>
    <a class="btn btn-secondary" href="{{ url_for('ui.index') }}">Cancel</a>
</form>
{% endblock %}
